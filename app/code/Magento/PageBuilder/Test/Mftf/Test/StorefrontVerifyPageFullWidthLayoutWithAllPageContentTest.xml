<?xml version="1.0" encoding="UTF-8"?>
<!--
 /**
  * Copyright © Magento, Inc. All rights reserved.
  * See COPYING.txt for license details.
  */
-->

<tests xmlns:xsi="http://www.w3.org/2001/XMLSchema-instance"
       xsi:noNamespaceSchemaLocation="urn:magento:mftf:Test/etc/testSchema.xsd">
    <test name="StorefrontVerifyPageFullWidthLayoutWithAllPageContentTest">
        <annotations>
            <features value="PageBuilder"/>
            <stories value="Catalog Products"/>
            <title value="Verify the Page – Full Width layout on the storefront with all page content"/>
            <description value="Verify the Page – Full Width layout on the storefront with all page content"/>
            <severity value="CRITICAL"/>
            <useCaseId value=""/>
            <testCaseId value="MC-15482"/>
            <group value="pagebuilder"/>
            <group value="pagebuilder-layout"/>
            <group value="pagebuilder-fullwidth"/>
            <group value="pagebuilder-cms-page"/>
        </annotations>
        <before>
            <actionGroup ref="AdminLoginActionGroup" stepKey="loginAsAdmin"/>
        </before>
        <after>
            <resizeWindow width="1280" height="1024" stepKey="resizeWindowToDesktop"/>
            <actionGroup ref="AdminDeleteCMSPageByUrlKeyActionGroup" stepKey="deleteCmsPage">
                <argument name="pageUrlKey" value="{{_cmsPageTestPageBuilderPageLayout.identifier}}"/>
            </actionGroup>
            <actionGroup ref="AdminLogoutActionGroup" stepKey="logout"/>
        </after>
        <!--Go to New CMS Page page-->
        <actionGroup ref="AdminOpenCreateNewCMSPageActionGroup" stepKey="navigateToCreateNewPage"/>
        <!-- Fill basic page information -->
        <fillField selector="{{CmsNewPagePageBasicFieldsSection.pageTitle}}" userInput="{{_cmsPageTestPageBuilderPageLayout.title}}" stepKey="fillTitle"/>
        <conditionalClick selector="{{CmsNewPagePageContentSection.header}}" dependentSelector="{{CmsNewPagePageContentSection.contentHeading}}" visible="false" stepKey="expandContentTabIfCollapsed"/>

        <!-- Add row and heading -->
        <actionGroup ref="switchToPageBuilderStage" stepKey="switchToPageBuilderStage"/>
        <actionGroup ref="dragContentTypeToStage" stepKey="dragRowToRootContainer">
            <argument name="contentType" value="PageBuilderRowContentType"/>
            <argument name="containerTargetType" value="PageBuilderRootContainerContentType"/>
        </actionGroup>
        <actionGroup ref="openPageBuilderEditPanelByIndex" stepKey="openEditMenuOnStage">
            <argument name="contentType" value="PageBuilderRowContentType"/>
        </actionGroup>
        <actionGroup ref="chooseVisualSelectOption" stepKey="enterAppearance">
            <argument name="property" value="PageBuilderRowAppearance_FullWidth"/>
        </actionGroup>
        <actionGroup ref="fillSlideOutPanelFieldGeneral" stepKey="enterBackgroundColor">
            <argument name="property" value="PageBuilderBackgroundColor_Sprout"/>
        </actionGroup>
        <actionGroup ref="saveEditPanelSettings" stepKey="saveEditPanelSettings"/>
        <actionGroup ref="expandPageBuilderPanelMenuSection" stepKey="expandPageBuilderPanelMenuSection">
            <argument name="contentType" value="PageBuilderHeadingContentType"/>
        </actionGroup>
        <actionGroup ref="dragContentTypeToContainer" stepKey="dragHeadingIntoStage">
            <argument name="contentType" value="PageBuilderHeadingContentType"/>
        </actionGroup>
        <actionGroup ref="enterHeadingOnStage" stepKey="enterHeadingOnStage">
            <argument name="headingText" value="PageBuilderHeadingTextSample4"/>
        </actionGroup>
        <actionGroup ref="clickOutsideLiveEditHeading" stepKey="clickOutsideLiveEditHeading">
            <argument name="index" value="1"/>
        </actionGroup>
        <actionGroup ref="exitPageBuilderFullScreen" stepKey="exitPageBuilderFullScreen"/>

        <!-- Fill URL Key -->
        <conditionalClick selector="{{CmsNewPagePageSeoSection.header}}" dependentSelector="{{CmsNewPagePageSeoSection.urlKey}}" visible="false" stepKey="clickExpandSearchEngineOptimisationIfCollapsed"/>
        <fillField selector="{{CmsNewPagePageSeoSection.urlKey}}" userInput="{{_cmsPageTestPageBuilderPageLayout.identifier}}" stepKey="fillUrlKey"/>

        <!-- Use Full Width layout -->
        <actionGroup ref="SetLayoutActionGroup" stepKey="setLayout">
            <argument name="designSection" value="CmsDesignSection"/>
            <argument name="layoutOption" value="PageBuilderFullWidthLayout.cms"/>
        </actionGroup>

        <!-- Save CMS Page -->
        <actionGroup ref="SaveAndContinueEditCmsPageActionGroup" stepKey="saveAndContinueEditCmsPage"/>

        <!-- Validate in Storefront - full screen -->
        <actionGroup ref="StorefrontGoToCMSPageActionGroup" stepKey="navigateToPageOnStoreFront">
            <argument name="identifier" value="{{_cmsPageTestPageBuilderPageLayout.identifier}}"/>
        </actionGroup>
        <actionGroup ref="verifyFullWidthLayout" stepKey="verifyFullWidthLayout"/>
        <waitForElementVisible selector="{{HeadingOnStorefront.headingText(PageBuilderHeadingTypeProperty_H2.value, PageBuilderHeadingTextSample4.value, '1')}}" stepKey="waitForStorefrontHeadingText"/>

        <!-- Validate in Storefront - 1600px width -->
        <resizeWindow width="1600" height="1024" stepKey="resizeWindowWidth"/>
        <actionGroup ref="verifyFullWidthLayout" stepKey="verifyFullWidthLayout2"/>
        <waitForElementVisible selector="{{HeadingOnStorefront.headingText(PageBuilderHeadingTypeProperty_H2.value, PageBuilderHeadingTextSample4.value, '1')}}" stepKey="waitForStorefrontHeadingText2"/>

        <!-- Validate in Storefront - 600px width -->
        <resizeWindow width="600" height="1000" stepKey="resizeWindowWidth2"/>
        <actionGroup ref="verifyFullWidthLayout" stepKey="verifyFullWidthLayout3"/>
        <waitForElementVisible selector="{{HeadingOnStorefront.headingText(PageBuilderHeadingTypeProperty_H2.value, PageBuilderHeadingTextSample4.value, '1')}}" stepKey="waitForStorefrontHeadingText3"/>
    </test>
</tests>
