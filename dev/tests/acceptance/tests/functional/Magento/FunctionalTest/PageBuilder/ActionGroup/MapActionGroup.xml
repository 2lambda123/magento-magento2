<?xml version="1.0" encoding="UTF-8"?>
<!--
 /**
  * Copyright Â© Magento, Inc. All rights reserved.
  * See COPYING.txt for license details.
  */
-->

<actionGroups xmlns:xsi="http://www.w3.org/2001/XMLSchema-instance"
        xsi:noNamespaceSchemaLocation="../../../../../../vendor/magento/magento2-functional-testing-framework/src/Magento/FunctionalTestingFramework/Test/etc/actionGroupSchema.xsd">
    <actionGroup name="clickMapToAddOrMovePin">
        <arguments>
            <argument name="x" defaultValue="null" type="string"/>
            <argument name="y" defaultValue="null" type="string"/>
        </arguments>
        <waitForElementVisible selector="{{MapOnConfigurationPanel.base}}" stepKey="waitForMapVisible"/>
        <clickWithLeftButton selector="{{MapOnConfigurationPanel.base}}" x="{{x}}" y="{{y}}" stepKey="clickMapToMovePin"/>
        <waitForElementVisible selector="{{MapOnConfigurationPanel.pin}}" stepKey="waitForPinVisible"/>
        <wait time="2" stepKey="waitForPinMove"/>
    </actionGroup>
    <actionGroup name="moveMapPinByDraggingAndDroppingPin">
        <arguments>
            <argument name="x" defaultValue="null" type="string"/>
            <argument name="y" defaultValue="null" type="string"/>
        </arguments>
        <waitForElementVisible selector="{{MapOnConfigurationPanel.clickablePin}}" stepKey="waitForMapVisible"/>
        <dragAndDrop selector1="{{MapOnConfigurationPanel.clickablePin}}" selector2="{{MapOnConfigurationPanel.clickablePin}}" x="{{x}}" y="{{y}}" stepKey="dragAndDropOnMapToMovePin"/>
        <wait time="2" stepKey="waitForPinMove"/>
    </actionGroup>
    <actionGroup name="verifyMapHasPin">
        <arguments>
            <argument name="page" defaultValue="MapOnStage"/>
            <argument name="index" defaultValue="1" type="string"/>
        </arguments>
        <waitForElementVisible selector="{{page.pin(index)}}" stepKey="waitForMapWithPin"/>
    </actionGroup>
    <actionGroup name="dontSeeMapPin">
        <arguments>
            <argument name="page" defaultValue="MapOnStage"/>
            <argument name="index" defaultValue="1" type="string"/>
        </arguments>
        <dontSeeElement selector="{{page.pin(index)}}" stepKey="dontSeeMapPin"/>
    </actionGroup>
    <actionGroup name="validateMapButtons">
        <arguments>
            <argument name="page" defaultValue="MapOnStage"/>
            <argument name="index" defaultValue="1" type="string"/>
        </arguments>
        <comment userInput="validateMapButtons" stepKey="comment"/>
        <waitForElementVisible selector="{{page.base(index)}}" stepKey="seeMap"/>
        <waitForElementVisible selector="{{page.fullScreen(index)}}" stepKey="waitForFullScreenButton"/>
        <waitForElementVisible selector="{{page.pegman(index)}}" stepKey="waitForMapPegman"/>
        <waitForElementVisible selector="{{page.satelliteView(index)}}" stepKey="waitForMapSatelliteView"/>
        <waitForElementVisible selector="{{page.streetView(index)}}" stepKey="waitForMapStreetView"/>
        <waitForElementVisible selector="{{page.zoomIn(index)}}" stepKey="waitForMapZoomIn"/>
        <waitForElementVisible selector="{{page.zoomOut(index)}}" stepKey="waitForMapZoomOut"/>
    </actionGroup>
    <actionGroup name="validateNoMapButtons">
        <arguments>
            <argument name="page" defaultValue="MapOnStage"/>
            <argument name="index" defaultValue="1" type="string"/>
        </arguments>
        <comment userInput="validateNoMapButtons" stepKey="comment"/>
        <waitForElementVisible selector="{{page.base(index)}}" stepKey="seeMap"/>
        <waitForElement selector="{{page.fullScreen(index)}}" stepKey="waitForFullScreenButton"/>
        <dontSeeElement selector="{{page.fullScreen(index)}}" stepKey="dontSeeFullScreenButton"/>
        <dontSeeElementInDOM selector="{{page.allPegmen(index)}}" stepKey="dontSeeMapPegman"/>
        <dontSeeElementInDOM selector="{{page.satelliteView(index)}}" stepKey="dontSeeMapSatelliteView"/>
        <dontSeeElementInDOM selector="{{page.streetView(index)}}" stepKey="dontSeeMapStreetView"/>
        <dontSeeElementInDOM selector="{{page.zoomIn(index)}}" stepKey="dontSeeMapZoomIn"/>
        <dontSeeElementInDOM selector="{{page.zoomOut(index)}}" stepKey="dontSeeMapZoomOut"/>
    </actionGroup>
    <actionGroup name="validateMapHelperText">
        <waitForElementVisible selector="{{MapOnConfigurationPanel.helperText}}" stepKey="seeMapHelperText"/>
    </actionGroup>
    <actionGroup name="validateMapSettings">
        <arguments>
            <argument name="page" defaultValue=""/>
            <argument name="height" defaultValue="PageBuilderMapHeightDefaultProperty"/>
            <argument name="showControls" defaultValue="PageBuilderMapShowControls_Default"/>
            <argument name="index" defaultValue="1" type="string"/>
        </arguments>
        <comment userInput="validateMapSettings" stepKey="comment"/>
        <waitForElementVisible selector="{{page.base(index)}}" stepKey="seeMap"/>
        <waitForElementVisible selector="{{page.height(index, height.value)}}" stepKey="waitForHeight"/>
        <waitForElementVisible selector="{{page.showControls(index, showControls.value)}}" stepKey="waitForShowControls"/>
    </actionGroup>
    <actionGroup name="validateEmptyMapStoreFront">
        <arguments>
            <argument name="index" defaultValue="1" type="string"/>
        </arguments>
        <comment userInput="validateEmptyMapStoreFront" stepKey="comment"/>
        <waitForElement selector="{{MapOnStorefront.emptyMap(index)}}" stepKey="seeInDOMEmptyMapOnFrontend"/>
        <dontSeeElement selector="{{MapOnStorefront.emptyMap(index)}}" stepKey="dontSeeEmptyMapOnFrontend"/>
        <executeJS function="return Math.round({{index}}-1)" stepKey="jSIndex"/>
        <executeJS function="return {{MapOnStorefront.baseJS('${jSIndex}')}}.clientHeight" stepKey="mapHeight"/>
        <assertEquals stepKey="assertMapHeightIsZero">
            <expectedResult type="int">0</expectedResult>
            <actualResult type="variable">$mapHeight</actualResult>
        </assertEquals>
    </actionGroup>
    <actionGroup name="validateMapPinLocationData">
        <arguments>
            <argument name="page" defaultValue=""/>
            <argument name="locationName" defaultValue="PageBuilderMapHeightDefaultProperty"/>
            <argument name="address" defaultValue="PageBuilderMapHeightDefaultProperty"/>
            <argument name="city" defaultValue="PageBuilderMapHeightDefaultProperty"/>
            <argument name="zip" defaultValue="PageBuilderMapHeightDefaultProperty"/>
            <argument name="country" defaultValue="PageBuilderMapHeightDefaultProperty"/>
            <argument name="comment" defaultValue="PageBuilderMapComment_Default"/>
            <argument name="index" defaultValue="1" type="string"/>
        </arguments>
        <comment userInput="validateMapPinLocationData" stepKey="comment1"/>
        <waitForElementVisible selector="{{page.clickablePin(index)}}" stepKey="waitForPin"/>
        <click selector="{{page.clickablePin(index)}}" stepKey="clickPin"/>
        <waitForElementVisible selector="{{page.tooltipWindow(index)}}" stepKey="waitForPinTooltip"/>
        <waitForElementVisible selector="{{page.locationName(index, locationName.value)}}" stepKey="waitForLocationName"/>
        <waitForElementVisible selector="{{page.address(index, address.value)}}" stepKey="waitForAddress"/>
        <waitForElementVisible selector="{{page.city(index, city.value)}}" stepKey="waitForCity"/>
        <waitForElementVisible selector="{{page.zip(index, zip.value)}}" stepKey="waitForZip"/>
        <waitForElementVisible selector="{{page.country(index, country.value)}}" stepKey="waitForCountry"/>
        <waitForElementVisible selector="{{page.comment(index, comment.value)}}" stepKey="waitForComment"/>
        <click selector="{{page.tooltipWindowClose(index)}}" stepKey="closePinTooltip"/>
        <waitForElementNotVisible selector="{{page.tooltipWindow(index)}}" stepKey="waitForPinTooltipGone"/>
    </actionGroup>
    <actionGroup name="validateNoPinTooltip">
        <comment userInput="validateNoPinTooltip" stepKey="comment"/>
        <waitForElementVisible selector="{{MapOnConfigurationPanel.clickablePin}}" stepKey="waitForPin"/>
        <click selector="{{MapOnConfigurationPanel.clickablePin}}" stepKey="clickPin"/>
        <dontSeeElementInDOM selector="{{MapOnConfigurationPanel.tooltipWindow}}" stepKey="dontSeeTooltip"/>
    </actionGroup>
    <actionGroup name="verifyPinLocationEqual">
        <arguments>
            <argument name="page" defaultValue=""/>
            <argument name="comparedPinLocation" type="string"/>
            <argument name="index" defaultValue="1" type="string"/>
        </arguments>
        <waitForElement selector="{{page.pinLocation(index)}}" stepKey="waitForPinLocation"/>
        <grabAttributeFrom selector="{{page.pinLocation(index)}}" userInput="style" stepKey="pinLocation"/>
        <assertEquals stepKey="assertPinPositionEqual">
            <expectedResult type="variable">{{comparedPinLocation}}</expectedResult>
            <actualResult type="variable">pinLocation</actualResult>
        </assertEquals>
    </actionGroup>
    <actionGroup name="verifyPinLocationNotEqual">
        <arguments>
            <argument name="page" defaultValue=""/>
            <argument name="comparedPinLocation" type="string"/>
            <argument name="index" defaultValue="1" type="string"/>
        </arguments>
        <waitForElement selector="{{page.pinLocation(index)}}" stepKey="waitForPinLocation"/>
        <grabAttributeFrom selector="{{page.pinLocation(index)}}" userInput="style" stepKey="pinLocation"/>
        <assertNotEquals stepKey="assertPinPositionNotEqual">
            <expectedResult type="variable">{{comparedPinLocation}}</expectedResult>
            <actualResult type="variable">pinLocation</actualResult>
        </assertNotEquals>
    </actionGroup>
    <actionGroup name="verifyCoordinatesNotEqual">
        <arguments>
            <argument name="property"/>
            <argument name="comparedCoordinate" type="string"/>
        </arguments>
        <waitForElementVisible selector="{{PageBuilderColumnSection.panelFieldControl(property.section, property.fieldName)}}" stepKey="waitForCoordinate"/>
        <grabValueFrom selector="{{PageBuilderColumnSection.panelFieldControl(property.section, property.fieldName)}}" stepKey="actualCoordinate"/>
        <assertNotEquals stepKey="assertCoordinateNotEqual">
            <expectedResult type="variable">{{comparedCoordinate}}</expectedResult>
            <actualResult type="variable">actualCoordinate</actualResult>
        </assertNotEquals>
    </actionGroup>
</actionGroups>
