<?xml version="1.0" encoding="UTF-8"?>
<!--
 /**
  * Copyright Â© Magento, Inc. All rights reserved.
  * See COPYING.txt for license details.
  */
-->

<actionGroups xmlns:xsi="http://www.w3.org/2001/XMLSchema-instance"
        xsi:noNamespaceSchemaLocation="../../../../../../vendor/magento/magento2-functional-testing-framework/src/Magento/FunctionalTestingFramework/Test/etc/actionGroupSchema.xsd">
    <actionGroup name="clickAddLocationButton">
        <comment userInput="clickAddLocationButton" stepKey="comment"/>
        <waitForPageLoad stepKey="waitForPageLoad1"/>
        <waitForElementVisible selector="{{EditMapForm.addLocationButton}}" stepKey="waitForAddLocationButton"/>
        <click selector="{{EditMapForm.addLocationButton}}" stepKey="clickAddLocationButton"/>
        <waitForPageLoad stepKey="waitForPageLoad2"/>
        <waitForElementVisible selector="{{AddLocationForm.form}}" stepKey="waitForForm"/>
        <see userInput="Add Location" selector="{{AddLocationForm.formTitle}}" stepKey="seeFormTitle"/>
        <waitForElementVisible selector="{{AddLocationForm.base}}" stepKey="waitForLocationMap"/>
        <waitForElementVisible selector="{{AddLocationForm.pegman('1')}}" stepKey="waitForLocationMapPegman"/>
    </actionGroup>
    <actionGroup name="saveLocationForm">
        <comment userInput="saveLocationForm" stepKey="comment"/>
        <waitForElementVisible selector="{{AddLocationForm.editFormSave}}" stepKey="waitForSaveButton"/>
        <click selector="{{AddLocationForm.editFormSave}}" stepKey="clickSaveButton"/>
        <waitForPageLoad stepKey="waitForPageLoad"/>
        <waitForElementNotVisible selector="{{AddLocationForm.form}}" stepKey="waitForAddLocationFormNotVisible"/>
        <waitForElementVisible selector="{{PageBuilderActionsSection.editFormSave}}" stepKey="waitForSaveEditMapFormButton"/>
    </actionGroup>
    <actionGroup name="closeLocationForm">
        <comment userInput="closeLocationForm" stepKey="comment"/>
        <waitForElementVisible selector="{{AddLocationForm.cancelButton}}" stepKey="waitForCancelButton"/>
        <click selector="{{AddLocationForm.cancelButton}}" stepKey="clickCancelButton"/>
        <waitForPageLoad stepKey="waitForPageLoad"/>
        <waitForElementNotVisible selector="{{AddLocationForm.form}}" stepKey="waitForAddLocationFormNotVisible"/>
        <waitForElementVisible selector="{{PageBuilderActionsSection.editFormSave}}" stepKey="waitForSaveEditMapFormButton"/>
    </actionGroup>
    <actionGroup name="clickLocationGridRow">
        <arguments>
            <argument name="locationName"/>
        </arguments>
        <comment userInput="clickEditOnLocationGridRow" stepKey="comment"/>
        <waitForElementVisible selector="{{PageBuilderDataGrid.gridRow(locationName.fieldName, locationName.value)}}" stepKey="waitForGridRow"/>
        <click selector="{{PageBuilderDataGrid.gridRow(locationName.fieldName, locationName.value)}}" stepKey="clickGridRow"/>
        <waitForPageLoad stepKey="waitForPageLoad"/>
        <waitForElementVisible selector="{{AddLocationForm.form}}" stepKey="waitForForm"/>
        <see userInput="Add Location" selector="{{AddLocationForm.formTitle}}" stepKey="seeFormTitle"/>
        <waitForElementVisible selector="{{AddLocationForm.base}}" stepKey="waitForLocationMap"/>
        <waitForElementVisible selector="{{AddLocationForm.pegman('1')}}" stepKey="waitForLocationMapPegman"/>
    </actionGroup>
    <actionGroup name="clickMapToAddOrMovePin">
        <arguments>
            <argument name="x" defaultValue="null" type="string"/>
            <argument name="y" defaultValue="null" type="string"/>
        </arguments>
        <waitForElementVisible selector="{{AddLocationForm.base}}" stepKey="waitForMapVisible"/>
        <clickWithLeftButton selector="{{AddLocationForm.base}}" x="{{x}}" y="{{y}}" stepKey="clickMapToMovePin"/>
        <waitForElementVisible selector="{{AddLocationForm.pin}}" stepKey="waitForPinVisible"/>
        <wait time="2" stepKey="waitForPinMove"/>
    </actionGroup>
    <actionGroup name="moveMapPinByDraggingAndDroppingPin">
        <arguments>
            <argument name="x" defaultValue="null" type="string"/>
            <argument name="y" defaultValue="null" type="string"/>
        </arguments>
        <waitForElementVisible selector="{{AddLocationForm.clickablePin}}" stepKey="waitForMapVisible"/>
        <dragAndDrop selector1="{{AddLocationForm.clickablePin}}" selector2="{{AddLocationForm.clickablePin}}" x="{{x}}" y="{{y}}" stepKey="dragAndDropOnMapToMovePin"/>
        <wait time="2" stepKey="waitForPinMove"/>
    </actionGroup>
    <actionGroup name="verifyMapHasPin">
        <arguments>
            <argument name="page" defaultValue="MapOnStage"/>
            <argument name="index" defaultValue="1" type="string"/>
        </arguments>
        <waitForElementVisible selector="{{page.pin(index)}}" stepKey="waitForMapWithPin"/>
    </actionGroup>
    <actionGroup name="dontSeeMapPin">
        <arguments>
            <argument name="page" defaultValue="MapOnStage"/>
            <argument name="index" defaultValue="1" type="string"/>
        </arguments>
        <dontSeeElement selector="{{page.pin(index)}}" stepKey="dontSeeMapPin"/>
    </actionGroup>
    <actionGroup name="validateMapButtons">
        <arguments>
            <argument name="page" defaultValue="MapOnStage"/>
            <argument name="index" defaultValue="1" type="string"/>
        </arguments>
        <comment userInput="validateMapButtons" stepKey="comment"/>
        <waitForElementVisible selector="{{page.base(index)}}" stepKey="seeMap"/>
        <waitForElementVisible selector="{{page.fullScreen(index)}}" stepKey="waitForFullScreenButton"/>
        <waitForElementVisible selector="{{page.pegman(index)}}" stepKey="waitForMapPegman"/>
        <waitForElementVisible selector="{{page.satelliteView(index)}}" stepKey="waitForMapSatelliteView"/>
        <waitForElementVisible selector="{{page.streetView(index)}}" stepKey="waitForMapStreetView"/>
        <waitForElementVisible selector="{{page.zoomIn(index)}}" stepKey="waitForMapZoomIn"/>
        <waitForElementVisible selector="{{page.zoomOut(index)}}" stepKey="waitForMapZoomOut"/>
    </actionGroup>
    <actionGroup name="validateNoMapButtons">
        <arguments>
            <argument name="page" defaultValue="MapOnStage"/>
            <argument name="index" defaultValue="1" type="string"/>
        </arguments>
        <comment userInput="validateNoMapButtons" stepKey="comment"/>
        <waitForElementVisible selector="{{page.base(index)}}" stepKey="seeMap"/>
        <waitForElement selector="{{page.fullScreen(index)}}" stepKey="waitForFullScreenButton"/>
        <dontSeeElement selector="{{page.fullScreen(index)}}" stepKey="dontSeeFullScreenButton"/>
        <dontSeeElementInDOM selector="{{page.allPegmen(index)}}" stepKey="dontSeeMapPegman"/>
        <dontSeeElementInDOM selector="{{page.satelliteView(index)}}" stepKey="dontSeeMapSatelliteView"/>
        <dontSeeElementInDOM selector="{{page.streetView(index)}}" stepKey="dontSeeMapStreetView"/>
        <dontSeeElementInDOM selector="{{page.zoomIn(index)}}" stepKey="dontSeeMapZoomIn"/>
        <dontSeeElementInDOM selector="{{page.zoomOut(index)}}" stepKey="dontSeeMapZoomOut"/>
    </actionGroup>
    <actionGroup name="validateMapHelperText">
        <waitForElementVisible selector="{{AddLocationForm.helperText}}" stepKey="seeMapHelperText"/>
    </actionGroup>
    <actionGroup name="validateMapSettings">
        <arguments>
            <argument name="page"/>
            <argument name="height" defaultValue="PageBuilderMapHeightDefaultProperty"/>
            <argument name="showControls" defaultValue="PageBuilderMapShowControls_Default"/>
            <argument name="index" defaultValue="1" type="string"/>
        </arguments>
        <comment userInput="validateMapSettings" stepKey="comment"/>
        <waitForElementVisible selector="{{page.base(index)}}" stepKey="seeMap"/>
        <waitForElementVisible selector="{{page.height(index, height.value)}}" stepKey="waitForHeight"/>
        <waitForElementVisible selector="{{page.showControls(index, showControls.value)}}" stepKey="waitForShowControls"/>
    </actionGroup>
    <actionGroup name="validateEmptyMapStoreFront">
        <arguments>
            <argument name="index" defaultValue="1" type="string"/>
        </arguments>
        <comment userInput="validateEmptyMapStoreFront" stepKey="comment"/>
        <waitForElement selector="{{MapOnStorefront.emptyMap(index)}}" stepKey="seeInDOMEmptyMapOnFrontend"/>
        <dontSeeElement selector="{{MapOnStorefront.emptyMap(index)}}" stepKey="dontSeeEmptyMapOnFrontend"/>
        <executeJS function="return Math.round({{index}}-1)" stepKey="jSIndex"/>
        <executeJS function="return {{MapOnStorefront.baseJS('${jSIndex}')}}.clientHeight" stepKey="mapHeight"/>
        <assertEquals stepKey="assertMapHeightIsZero">
            <expectedResult type="int">0</expectedResult>
            <actualResult type="variable">$mapHeight</actualResult>
        </assertEquals>
    </actionGroup>
    <actionGroup name="validateMapPinLocationData">
        <arguments>
            <argument name="page"/>
            <argument name="locationName" defaultValue="PageBuilderMapLocationName_Default"/>
            <argument name="comment" defaultValue="PageBuilderMapComment_Default"/>
            <argument name="phoneNumber" defaultValue="PageBuilderMapPhoneNumber_Default"/>
            <argument name="address" defaultValue="PageBuilderMapStreetAddress_Default"/>
            <argument name="city" defaultValue="PageBuilderMapCity_Default"/>
            <argument name="zip" defaultValue="PageBuilderMapZipCode_Default"/>
            <argument name="country" defaultValue="PageBuilderMapCountry_Default"/>
            <argument name="index" defaultValue="1" type="string"/>
        </arguments>
        <comment userInput="validateMapPinLocationData" stepKey="comment1"/>
        <waitForElementVisible selector="{{page.clickablePin(index)}}" stepKey="waitForPin"/>
        <click selector="{{page.clickablePin(index)}}" stepKey="clickPin"/>
        <waitForElementVisible selector="{{page.tooltipWindow(index)}}" stepKey="waitForPinTooltip"/>
        <waitForElementVisible selector="{{page.locationName(index, locationName.value)}}" stepKey="waitForLocationName"/>
        <waitForElementVisible selector="{{page.comment(index, comment.value)}}" stepKey="waitForComment"/>
        <waitForElementVisible selector="{{page.phoneNumber(index, phoneNumber.value)}}" stepKey="waitForPhoneNumber"/>
        <waitForElementVisible selector="{{page.addressCityZipCountry(index, address.value, city.value, zip.tooltipValue, country.tooltipValue)}}" stepKey="waitForAddress"/>
        <click selector="{{page.tooltipWindowClose(index)}}" stepKey="closePinTooltip"/>
        <waitForElementNotVisible selector="{{page.tooltipWindow(index)}}" stepKey="waitForPinTooltipGone"/>
    </actionGroup>
    <actionGroup name="validateMapPinLocationDataWithOnlyLocationName">
        <arguments>
            <argument name="page"/>
            <argument name="locationName" defaultValue="PageBuilderMapLocationName_Default"/>
            <argument name="index" defaultValue="1" type="string"/>
        </arguments>
        <comment userInput="validateMapPinLocationDataWithNoCommentOrPhoneNumber" stepKey="comment1"/>
        <waitForElementVisible selector="{{page.clickablePin(index)}}" stepKey="waitForPin"/>
        <click selector="{{page.clickablePin(index)}}" stepKey="clickPin"/>
        <waitForElementVisible selector="{{page.tooltipWindow(index)}}" stepKey="waitForPinTooltip"/>
        <waitForElementVisible selector="{{page.locationName(index, locationName.value)}}" stepKey="waitForLocationName"/>
        <dontSeeElementInDOM selector="{{page.comment(index, PageBuilderMapComment_Default.value)}}" stepKey="dontSeeComment"/>
        <dontSeeElementInDOM selector="{{page.phoneNumber(index, PageBuilderMapPhoneNumber_Default.value)}}" stepKey="dontSeePhoneNumber"/>
        <waitForElement selector="{{page.addressCityZipCountry(index, PageBuilderMapStreetAddress_Default.value, PageBuilderMapCity_Default.value, PageBuilderMapZipCode_Default.tooltipValue, PageBuilderMapCountry_Default.tooltipValue)}}" stepKey="waitForAddress"/>
        <dontSeeElement selector="{{page.addressCityZipCountry(index, PageBuilderMapStreetAddress_Default.value, PageBuilderMapCity_Default.value, PageBuilderMapZipCode_Default.tooltipValue, PageBuilderMapCountry_Default.tooltipValue)}}" stepKey="dontSeeAddress"/>
        <click selector="{{page.tooltipWindowClose(index)}}" stepKey="closePinTooltip"/>
        <waitForElementNotVisible selector="{{page.tooltipWindow(index)}}" stepKey="waitForPinTooltipGone"/>
    </actionGroup>
    <actionGroup name="validateMapPinLocationDataWithNoCommentOrPhoneNumber">
        <arguments>
            <argument name="page"/>
            <argument name="locationName" defaultValue="PageBuilderMapLocationName_Default"/>
            <argument name="address" defaultValue="PageBuilderMapStreetAddress_Default"/>
            <argument name="city" defaultValue="PageBuilderMapCity_Default"/>
            <argument name="zip" defaultValue="PageBuilderMapZipCode_Default"/>
            <argument name="country" defaultValue="PageBuilderMapCountry_Default"/>
            <argument name="index" defaultValue="1" type="string"/>
        </arguments>
        <comment userInput="validateMapPinLocationDataWithNoCommentOrPhoneNumber" stepKey="comment1"/>
        <waitForElementVisible selector="{{page.clickablePin(index)}}" stepKey="waitForPin"/>
        <click selector="{{page.clickablePin(index)}}" stepKey="clickPin"/>
        <waitForElementVisible selector="{{page.tooltipWindow(index)}}" stepKey="waitForPinTooltip"/>
        <waitForElementVisible selector="{{page.locationName(index, locationName.value)}}" stepKey="waitForLocationName"/>
        <dontSeeElementInDOM selector="{{page.comment(index, PageBuilderMapComment_Default.value)}}" stepKey="dontSeeComment"/>
        <dontSeeElementInDOM selector="{{page.phoneNumber(index, PageBuilderMapPhoneNumber_Default.value)}}" stepKey="dontSeePhoneNumber"/>
        <waitForElementVisible selector="{{page.addressCityZipCountry(index, address.value, city.value, zip.tooltipValue, country.tooltipValue)}}" stepKey="waitForAddress"/>
        <click selector="{{page.tooltipWindowClose(index)}}" stepKey="closePinTooltip"/>
        <waitForElementNotVisible selector="{{page.tooltipWindow(index)}}" stepKey="waitForPinTooltipGone"/>
    </actionGroup>
    <actionGroup name="validateNoPinTooltip">
        <comment userInput="validateNoPinTooltip" stepKey="comment"/>
        <waitForElementVisible selector="{{AddLocationForm.clickablePin}}" stepKey="waitForPin"/>
        <click selector="{{AddLocationForm.clickablePin}}" stepKey="clickPin"/>
        <dontSeeElementInDOM selector="{{AddLocationForm.tooltipWindow}}" stepKey="dontSeeTooltip"/>
    </actionGroup>
    <actionGroup name="verifyPinLocationEqual">
        <arguments>
            <argument name="page"/>
            <argument name="comparedPinLocation" type="string"/>
            <argument name="index" defaultValue="1" type="string"/>
        </arguments>
        <waitForElement selector="{{page.pinLocation(index)}}" stepKey="waitForPinLocation"/>
        <grabAttributeFrom selector="{{page.pinLocation(index)}}" userInput="style" stepKey="pinLocation"/>
        <assertEquals stepKey="assertPinPositionEqual">
            <expectedResult type="variable">{{comparedPinLocation}}</expectedResult>
            <actualResult type="variable">pinLocation</actualResult>
        </assertEquals>
    </actionGroup>
    <actionGroup name="verifyPinLocationNotEqual">
        <arguments>
            <argument name="page"/>
            <argument name="comparedPinLocation" type="string"/>
            <argument name="index" defaultValue="1" type="string"/>
        </arguments>
        <waitForElement selector="{{page.pinLocation(index)}}" stepKey="waitForPinLocation"/>
        <grabAttributeFrom selector="{{page.pinLocation(index)}}" userInput="style" stepKey="pinLocation"/>
        <assertNotEquals stepKey="assertPinPositionNotEqual">
            <expectedResult type="variable">{{comparedPinLocation}}</expectedResult>
            <actualResult type="variable">pinLocation</actualResult>
        </assertNotEquals>
    </actionGroup>
    <actionGroup name="verifyCoordinatesNotEqual">
        <arguments>
            <argument name="property"/>
            <argument name="comparedCoordinate" type="string"/>
        </arguments>
        <waitForElementVisible selector="{{PageBuilderColumnSection.panelFieldControl(property.section, property.fieldName)}}" stepKey="waitForCoordinate"/>
        <grabValueFrom selector="{{PageBuilderColumnSection.panelFieldControl(property.section, property.fieldName)}}" stepKey="actualCoordinate"/>
        <assertNotEquals stepKey="assertCoordinateNotEqual">
            <expectedResult type="variable">{{comparedCoordinate}}</expectedResult>
            <actualResult type="variable">actualCoordinate</actualResult>
        </assertNotEquals>
    </actionGroup>
    <actionGroup name="verifyMapLatitudeAndLongitude">
        <arguments>
            <argument name="page"/>
            <argument name="latitude"/>
            <argument name="longitude"/>
            <argument name="index" defaultValue="1" type="string"/>
        </arguments>
        <comment userInput="verifyMapLatitudeAndLongitude" stepKey="comment"/>
        <waitForElementVisible selector="{{page.base(index)}}" stepKey="waitForMap"/>
        <waitForElementVisible selector="{{page.latitude(index, latitude.value)}}" stepKey="waitForLatitude"/>
        <waitForElementVisible selector="{{page.longitude(index, longitude.value)}}" stepKey="waitForLongitude"/>
    </actionGroup>
    <actionGroup name="verifyMapLatitudeAndLongitudeAlternate">
        <!-- Need an alternate action group: MQE-965 -->
        <arguments>
            <argument name="page"/>
            <argument name="latitude" type="string"/>
            <argument name="longitude" type="string"/>
            <argument name="index" defaultValue="1" type="string"/>
        </arguments>
        <comment userInput="verifyMapLatitudeAndLongitudeAlternate" stepKey="comment"/>
        <waitForElementVisible selector="{{page.base(index)}}" stepKey="waitForMap"/>
        <waitForElementVisible selector="{{page.latitude(index, latitude)}}" stepKey="waitForLatitude"/>
        <waitForElementVisible selector="{{page.longitude(index, longitude)}}" stepKey="waitForLongitude"/>
    </actionGroup>
</actionGroups>
