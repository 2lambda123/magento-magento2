<?xml version="1.0" encoding="UTF-8"?>
<!--
 /**
  * Copyright Â© Magento, Inc. All rights reserved.
  * See COPYING.txt for license details.
  */
-->

<tests xmlns:xsi="http://www.w3.org/2001/XMLSchema-instance"
        xsi:noNamespaceSchemaLocation="../../../../../../vendor/magento/magento2-functional-testing-framework/src/Magento/FunctionalTestingFramework/Test/etc/testSchema.xsd">
    <test name="VerifyPageBuilderVisibleOnStagingOfPages">
        <annotations>
            <title value="Admin are able to see PageBuilder on Staging of CMS Page, Block Page after enable PageBuilder from Configuration"/>
            <description value="Admin are able to see PageBuilder on Staging of CMS Page, Block Page after enable PageBuilder from Configuration"/>
            <severity value="CRITICAL"/>
            <group value="pagebuilder"/>
            <!-- Fix test in MAGETWO-90239 -->
            <group value="skip"/>
        </annotations>
        <before>
            <actionGroup ref="LoginAsAdmin" stepKey="loginAsAdmin"/>
            <actionGroup ref="enablePageBuilderSetting" stepKey="enablePageBuilder"/>
            <createData entity="_defaultCmsPage" stepKey="createPreReqCMSPage" />
            <createData entity="_defaultBlock" stepKey="createPreReqBlock" />
        </before>
        <after>
            <deleteData createDataKey="createPreReqCMSPage" stepKey="deleteCreatePreReqCMSPage"/>
            <deleteData createDataKey="createPreReqBlock" stepKey="deleteCreatePreReqBlock"/>
            <actionGroup ref="logout" stepKey="logout"/>
        </after>
        <!--Verify PageBuilder visible on CMS Page creation form-->
        <actionGroup ref="navigateToCreatedCMSPage" stepKey="navigateToContentCreatedCMSPage1">
            <argument name="CMSPage" value="$$createPreReqCMSPage$$"/>
        </actionGroup>
        <actionGroup ref="navigateToStagingSlideout" stepKey="navigateToStagingSlideoutCMS"/>
        <click selector="{{AdminStagingSlideOutSection.contentTab}}" stepKey="expandContentTab" />
        <actionGroup ref="verifyPageBuilderVisibleOnPage" stepKey="verifyPageBuilderVisibleOnCMSStaging"/>
        <!--Verify PageBuilder visible on CMS Block creation form-->
        <actionGroup ref="navigateToCreatedCMSBlockPage" stepKey="navigateToContentCreatedBlock">
            <argument name="CMSBlockPage" value="$$createPreReqBlock$$"/>
        </actionGroup>
        <actionGroup ref="navigateToStagingSlideout" stepKey="navigateToStagingSlideoutBlock"/>
        <actionGroup ref="verifyPageBuilderVisibleOnPage" stepKey="verifyPageBuilderVisibleOnBlockStaging"/>
    </test>
    <test name="VerifyPageBuilderVisibleOnPages">
        <annotations>
            <title value="Admin are able to see PageBuilder on CMS Page, Block Page, Dynmic Block after enable PageBuilder from Configuration"/>
            <description value="Admin are able to see PageBuilder on CMS Page, Block Page, Dynmic Block after enable PageBuilder from Configuration"/>
            <severity value="CRITICAL"/>
            <group value="pagebuilder"/>
            <!-- Fix test in MAGETWO-90239 -->
            <group value="skip"/>
        </annotations>
        <before>
            <actionGroup ref="LoginAsAdmin" stepKey="loginAsAdmin"/>
            <actionGroup ref="enablePageBuilderSetting" stepKey="enablePageBuilder"/>
            <createData entity="_defaultCmsPage" stepKey="createPreReqCMSPage" />
            <createData entity="_defaultBlock" stepKey="createPreReqBlock" />
        </before>
        <after>
            <deleteData createDataKey="createPreReqCMSPage" stepKey="deleteCreatePreReqCMSPage"/>
            <deleteData createDataKey="createPreReqBlock" stepKey="deleteCreatePreReqBlock"/>
            <actionGroup ref="logout" stepKey="logout"/>
        </after>
        <!--Verify PageBuilder visible on CMS Page creation form-->
        <actionGroup ref="navigateToCreatedCMSPage" stepKey="navigateToContentCreatedCMSPage1">
            <argument name="CMSPage" value="$$createPreReqCMSPage$$"/>
        </actionGroup>
        <actionGroup ref="verifyPageBuilderVisibleOnPage" stepKey="verifyPageBuilderVisibleOnCMSPage"/>
        <!--Verify PageBuilder visible on staging slideout of CMS Page-->
        <actionGroup ref="navigateToStagingSlideout" stepKey="navigateToStagingSlideoutCMS"/>
        <click selector="{{AdminStagingSlideOutSection.contentTab}}" stepKey="expandContentTab" />
        <actionGroup ref="verifyPageBuilderVisibleOnPage" stepKey="verifyPageBuilderVisibleOnCMSStaging"/>
        <!--Verify PageBuilder visible on CMS Block creation form-->
        <actionGroup ref="navigateToCreatedCMSBlockPage" stepKey="navigateToContentCreatedBlock">
            <argument name="CMSBlockPage" value="$$createPreReqBlock$$"/>
        </actionGroup>
        <actionGroup ref="verifyPageBuilderVisibleOnPage" stepKey="verifyPageBuilderVisibleOnBlockPage"/>
        <!--Verify PageBuilder visible on staging slideout of CMS Block-->
        <actionGroup ref="navigateToStagingSlideout" stepKey="navigateToStagingSlideoutBlock"/>
        <actionGroup ref="verifyPageBuilderVisibleOnPage" stepKey="verifyPageBuilderVisibleOnBlockStaging"/>
        <!--Verify PageBuilder visible on Newsletter creation form-->
        <amOnPage url="{{NewsletterTemplateForm.url}}" stepKey="amOnNewsletterTemplatePage"/>
        <waitForPageLoad stepKey="waitForPageLoad6"/>
        <dontSee userInput="Enable Advanced CMS" stepKey="dontSeeEnableAdvancedCMSBtn"/>
        <actionGroup ref="verifyPageBuilderNotVisibleOnPage" stepKey="dontSeePageBuilderOnPage"/>
        <seeElement selector="{{NewsletterWYSIWYGSection.TextArea}}" stepKey="seeTextArea"/>
        <!--Verify PageBuilder visible on Dynamic Block creation form -->
        <amOnPage url="{{AdminBannerPage.url}}" stepKey="openNewBannerForm"/>
        <waitForPageLoad stepKey="waitForPageLoad5"/>
        <actionGroup ref="verifyPageBuilderVisibleOnPage" stepKey="verifyBluefootVisibleOnBlockPage"/>
        <!--Verify PageBuilder enable on staging slideout of CMS Block Page-->
        <actionGroup ref="navigateToStagingSlideout" stepKey="navigateToStagingSlideout"/>
        <actionGroup ref="verifyPageBuilderVisibleOnPage" stepKey="seePageBuilderOnStaging"/>
    </test>
</tests>
